---
title: How it works
---

import { Steps } from '@astrojs/starlight/components'

<Steps>

1. _State_ is initiated using class fields. The class must be extended from
   2n8's parent class which enhances the store with a few utilities.

   ```tsx
   import { TwoAndEight } from '2n8'

   class Store extends TwoAndEight {
     counter = 0
   }
   ```

2. State changes are made inside _actions_, which are simply class methods that
   mutate the fields.

   ```tsx
   import { TwoAndEight } from '2n8'

   class Store extends TwoAndEight {
     counter = 0

     addButtonClicked() {
       this.counter++
     }
   }
   ```

3. Generate your React hook:

   ```tsx
   import { createReactStore } from '2n8'

   const useStore = createReactStore(new Store())
   ```

   This uses React's
   [`useSyncExternalStore`](https://react.dev/reference/react/useSyncExternalStore)
   hook to _subscribe_ to state changes:

   ```tsx
   const Component = () => {
     const counter = useStore('counter')

     return <div>{counter}</div>
   }
   ```

   When, and only when, the selected state changes, the component is rerendered
   by React. This is more optimal than simply passing state down the component
   tree via props.

4. Select and call actions from the store:

   ```tsx
   const Component2 = () => {
     const addButtonClicked = useStore('addButtonClicked')

     return <button onClick={addButtonClicked}>Add</button>
   }
   ```

   When actions are called, the current values of all state is _emitted_ to the
   subscribers at the end of the action.

</Steps>
